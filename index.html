<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Katana — One Pager</title>

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="assets/css/main.css">
  
  <!-- Katana HYG Signals CSS -->
  <style>
    /* Katana Production CSS for Signals Dashboard */
    .signals-dashboard {
      background: linear-gradient(135deg, #1a1f2e 0%, #232B42 100%);
      border-radius: 12px;
      padding: 2rem;
      margin: 3rem 0;
    }
    
    .signals-header {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      padding: 2rem 3rem;
      margin-bottom: 3rem;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .signals-header h2 {
      margin: 0 0 1rem 0;
      font-size: 2.8rem;
      font-weight: 700;
      background: linear-gradient(135deg, #01a8b5 0%, #00d4e4 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .header-info {
      display: flex;
      gap: 3rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.3rem;
    }
    
    .header-info strong {
      color: rgba(255, 255, 255, 0.87);
    }
    
    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }
    
    .stat-card {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      padding: 1.5rem;
      border: 1px solid rgba(255, 255, 255, 0.05);
      transition: all 0.3s ease;
    }
    
    .stat-card:hover {
      background: rgba(255, 255, 255, 0.05);
      transform: translateY(-2px);
    }
    
    .stat-label {
      color: rgba(255, 255, 255, 0.5);
      font-size: 1.1rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }
    
    .stat-value {
      font-size: 2.4rem;
      font-weight: 700;
      color: #01a8b5;
    }
    
    /* Controls */
    .controls {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      display: flex;
      gap: 1.5rem;
      flex-wrap: wrap;
      align-items: center;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .search-box {
      flex: 1;
      min-width: 300px;
    }
    
    .search-box input {
      width: 100%;
      padding: 0.8rem 1.2rem;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      color: rgba(255, 255, 255, 0.87);
      font-size: 1.3rem;
      transition: all 0.3s ease;
    }
    
    .search-box input:focus {
      border-color: #01a8b5;
      background: rgba(0, 0, 0, 0.5);
    }
    
    .filter-group {
      display: flex;
      gap: 1rem;
      align-items: center;
    }
    
    .filter-group label {
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
    }
    
    .filter-group select {
      padding: 0.6rem 1rem;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      color: rgba(255, 255, 255, 0.87);
      font-size: 1.2rem;
      cursor: pointer;
    }
    
    /* Table */
    .table-container {
      background: rgba(255, 255, 255, 0.02);
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    /* Enhanced Katana Table Styles */
    .table-card {
      max-width: 1400px;
      margin: 0 auto 2rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.02);
      overflow-x: auto;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      transition: box-shadow 0.3s ease;
    }
    
    .table-card:hover {
      box-shadow: 0 12px 40px rgba(0,0,0,0.4);
    }
    
    #signalsTable {
      width: 100%;
      border-collapse: collapse;
      font-size: 1.3rem;
      table-layout: fixed;
    }
    
    #signalsTable thead th {
      position: sticky;
      top: 0;
      z-index: 1;
      background: rgba(0, 0, 0, 0.5);
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.05em;
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.875rem;
      padding: 1rem 0.75rem;
      text-align: center;
      vertical-align: middle;
    }
    
    #signalsTable th, #signalsTable td {
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    #signalsTable tbody tr:nth-child(odd) {
      background: rgba(255, 255, 255, 0.02);
    }
    
    #signalsTable tbody tr:nth-child(even) {
      background: rgba(255, 255, 255, 0.01);
    }
    
    #signalsTable tbody tr:hover {
      background: rgba(1, 168, 181, 0.1) !important;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    
    #signalsTable tbody tr.selected {
      background: rgba(1, 168, 181, 0.15) !important;
      border-left: 3px solid #01a8b5;
    }
    
    #signalsTable td {
      padding: 1rem 0.75rem;
      text-align: center;
      vertical-align: middle;
      color: rgba(255, 255, 255, 0.87);
    }
    
    .priority {
      font-weight: 600;
      font-size: 1.1rem;
      white-space: nowrap;
      color: #01a8b5;
    }
    
    .description {
      text-align: left;
      min-width: 280px;
    }
    
    .bond-title {
      font-weight: 600;
      font-size: 1rem;
      line-height: 1.3;
      color: rgba(255, 255, 255, 0.87);
      margin-bottom: 0.25rem;
    }
    
    .bond-sub {
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.5);
      font-weight: 400;
    }
    
    .metric {
      font-weight: 600;
      white-space: nowrap;
      font-size: 1rem;
    }
    
    .positive { 
      color: #43DEAF; 
      font-weight: 600;
    }
    
    .negative { 
      color: #DE4383;
      font-weight: 600;
    }
    
    .signal {
      font-weight: 600;
      text-transform: uppercase;
      white-space: nowrap;
      font-size: 0.875rem;
      letter-spacing: 0.05em;
    }
    
    .signal-strong {
      background: linear-gradient(135deg, #43DEAF, rgba(67, 222, 175, 0.8));
      color: #1a1f2e;
      padding: 0.375rem 0.75rem;
      border-radius: 8px;
      display: inline-block;
      font-weight: 700;
      box-shadow: 0 2px 8px rgba(67, 222, 175, 0.3);
    }
    
    .signal-moderate {
      background: rgba(243, 174, 75, 0.2);
      color: #F3AE4B;
      padding: 0.375rem 0.75rem;
      border-radius: 8px;
      display: inline-block;
      border: 1px solid rgba(243, 174, 75, 0.4);
    }
    
    .signal-weak {
      background: rgba(255, 255, 255, 0.05);
      color: rgba(255, 255, 255, 0.5);
      padding: 0.375rem 0.75rem;
      border-radius: 8px;
      display: inline-block;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .confidence {
      text-align: center;
      white-space: nowrap;
      min-width: 100px;
    }
    
    .confidence-bar {
      background: rgba(255, 255, 255, 0.05);
      height: 10px;
      border-radius: 6px;
      overflow: hidden;
      margin: 0 auto 0.5rem auto;
      width: 100px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .confidence-fill {
      background: linear-gradient(90deg, #01a8b5, rgba(1, 168, 181, 0.8));
      height: 100%;
      transition: width 0.3s ease;
      border-radius: 4px;
    }
    
    .confidence-text {
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.6);
      font-weight: 600;
    }
    
    .match-indicator { 
      font-size: 1.2rem;
      line-height: 1;
    }
    
    .footer {
      max-width: 1400px;
      margin: 0 auto 2rem;
      color: rgba(255, 255, 255, 0.4);
      font-size: 0.875rem;
      padding: 1rem 1.5rem;
      text-align: center;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      background: rgba(0, 0, 0, 0.2);
      border-radius: 0 0 12px 12px;
    }
    
    /* Cell Styles */
    .priority {
      font-weight: 700;
      color: #01a8b5;
      text-align: center;
    }
    
    .ticker {
      font-weight: 600;
      color: rgba(255, 255, 255, 0.95);
    }
    
    .description {
      color: rgba(255, 255, 255, 0.7);
      font-size: 1.2rem;
    }
    
    .price {
      font-weight: 600;
      text-align: right;
    }
    
    .ytm {
      text-align: right;
      color: #f9e2af;
    }
    
    .positive {
      color: #a6e3a1;
    }
    
    .negative {
      color: #f38ba8;
    }
    
    .signal-strong {
      background: linear-gradient(135deg, #a6e3a1 0%, #94e2d5 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 700;
    }
    
    .signal-medium {
      color: #f9e2af;
      font-weight: 600;
    }
    
    .signal-weak {
      color: rgba(255, 255, 255, 0.5);
    }
    
    .confidence-bar {
      width: 100px;
      height: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      overflow: hidden;
      position: relative;
    }
    
    .confidence-fill {
      height: 100%;
      background: linear-gradient(90deg, #01a8b5 0%, #00d4e4 100%);
      transition: width 0.3s ease;
    }
    
    /* Responsive */
    @media (max-width: 1400px) {
      .signals-dashboard {
        padding: 1rem;
      }
      
      .table-container {
        overflow-x: auto;
      }
      
      #signalsTable {
        min-width: 1200px;
      }
    }
  </style>
</head>
<body>
  <!-- Top navigation -->
  <nav class="nav" role="navigation" aria-label="Primary">
    <a class="nav-brand" href="./">Katana</a>
    <a class="nav-link nav-link--active" href="./index.html">One Pager</a>
    <a class="nav-link" href="./katana-complete-investment-thesis.html">Investment Thesis</a>
    <a class="nav-link" href="./rebuild.html">Rebuild</a>
    <a class="nav-link" href="./vision.html">Vision</a>
    <a class="nav-link" href="./katana-hyg-signals.html">Live Signals</a>
    <a class="nav-link" href="#chat">Chat With The Code</a>
    <a class="nav-link" href="#contact">Contact</a>
  </nav>

  <main class="container landing" id="story">
    <!-- Hero -->
    <section class="hero">
      <h1 class="hero-title">3.5 years. One engineer. Zero shortcuts.</h1>
      <p class="hero-subtitle"><em>(And a wife that’s about to murder him.)</em></p>
      <div class="hero-cta">
        <a class="btn btn--primary btn--large" href="#rebuild">How we built it →</a>
        <a class="btn btn--success" href="https://www.johnshelburne.com" target="_blank" rel="noopener">Talk to us</a>
      </div>
    </section>

    <!-- Origin / Acquisition -->
    <section id="origin" class="blog-post">
      <header class="blog-post-header">
        <h2 class="blog-post-title">Origin & Acquisition</h2>
      </header>
      <div class="blog-post-content">
        <p>ING spinout (£5M peak). PGGM deployment. Awards. Tier-1 clients. Acquired in liquidation for £25k. I lived in the code for 3.5 years.</p>
      </div>
    </section>

    <!-- Journey -->
    <section class="blog-post">
      <header class="blog-post-header">
        <h2 class="blog-post-title">Journey</h2>
      </header>
      <div class="blog-post-content">
        <ul class="blog-post-list">
          <li class="blog-post-list-item">5–6 years on a bond desk → felt the pain first-hand.</li>
          <li class="blog-post-list-item">Head of Sales (North America) → fell in love with the tech.</li>
          <li class="blog-post-list-item">No code → full-stack → agentic engineering.</li>
        </ul>
      </div>
    </section>

    <!-- Rebuild -->
    <div class="main-layout" id="rebuild">
      <section class="main-content blog-post">
        <header class="blog-post-header">
          <h2 class="blog-post-title">Rebuild: Fundamentals + Agents</h2>
        </header>
        <div class="blog-post-content">
          <p>Domain-driven design foundation. Not AI slop. Agents operate on strong fundamentals. We solved illiquidity by using ETFs as proxies and checking execution feasibility.</p>
          <!-- Code-styled explainer -->
          <div class="code-block syntax-highlight" role="region" aria-label="Signal to execution pipeline">
            <span class="code-line"><span class="keyword">for</span> bond_pair <span class="keyword">in</span> universe(100000):</span>
            <span class="code-line code-line--no-prompt">  p = model.reversion_probability(bond_pair) <span class="comment">// deep learning</span></span>
            <span class="code-line code-line--no-prompt">  liq = etf_proxy.liquidity_score(bond_pair) <span class="comment">// ETF as liquidity</span></span>
            <span class="code-line code-line--no-prompt">  <span class="keyword">if</span> feasible(liq) <span class="keyword">and</span> p &gt; threshold:</span>
            <span class="code-line code-line--no-prompt">    agent.execute_checklist(bond_pair) <span class="comment">// agentic execution checks</span></span>
          </div>
        </div>
        <div class="blog-post-content">
          <a class="btn btn--warning" href="#vision">See the outputs ↓</a>
        </div>
      </section>

      <!-- Sidebar proof -->
      <aside class="aside-content sidebar">
        <div class="sidebar-section">
          <div class="sidebar-title">Proof</div>
          <ul class="sidebar-list">
            <li class="sidebar-list-item">Institutional DNA</li>
            <li class="sidebar-list-item">AI-powered reinvention</li>
            <li class="sidebar-list-item">Sale-ready</li>
          </ul>
        </div>
        <div class="sidebar-section">
          <div class="sidebar-title">Tagline</div>
          <a class="sidebar-link" href="https://www.johnshelburne.com" target="_blank" rel="noopener">Signals → Liquidity → Execution</a>
        </div>
      </aside>
    </div>

    <!-- Vision / Stats -->
    <section id="vision" class="stats">
      <div class="stat"><span class="stat-number">100k+</span><span class="stat-label">Bonds scanned</span></div>
      <div class="stat"><span class="stat-number">DL</span><span class="stat-label">Reversion probability</span></div>
      <div class="stat"><span class="stat-number">ETF</span><span class="stat-label">Liquidity proxy</span></div>
      <div class="stat"><span class="stat-number">Exec</span><span class="stat-label">Feasibility checked</span></div>
    </section>

    <!-- Live HYG Bond Signals Dashboard -->
    <section id="signals" class="signals-dashboard">
      <div class="signals-header">
        <h2>Katana HYG Bond Signals</h2>
        <div class="header-info">
          <div><strong>Generated:</strong> 2025-09-08 17:28:47 UTC</div>
          <div><strong>Total Signals:</strong> <span id="totalSignals">50</span></div>
          <div><strong>Data Source:</strong> BlackRock HYG ETF Holdings</div>
        </div>
      </div>
      
      <!-- Stats Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Avg Price Differential</div>
          <div class="stat-value">$60.65</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Avg Yield Differential</div>
          <div class="stat-value">45.51%</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Avg Spread Compression</div>
          <div class="stat-value">4543 bps</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Avg Confidence</div>
          <div class="stat-value">100.0%</div>
        </div>
      </div>
      
      <!-- Controls -->
      <div class="controls">
        <div class="search-box">
          <input type="text" id="searchInput" placeholder="Search by ticker, ISIN, or description...">
        </div>
        <div class="filter-group">
          <label>Signal Strength:</label>
          <select id="signalFilter">
            <option value="">All</option>
            <option value="STRONG">Strong</option>
            <option value="MEDIUM">Medium</option>
            <option value="WEAK">Weak</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Min Confidence:</label>
          <select id="confidenceFilter">
            <option value="0">All</option>
            <option value="50">50%+</option>
            <option value="75">75%+</option>
            <option value="90">90%+</option>
          </select>
        </div>
      </div>
      
      <!-- Enhanced Katana Table -->
      <div class="table-card">
        <table id="signalsTable" aria-describedby="tableDesc">
          <thead>
            <tr>
              <th>#</th>
              <th>Buy Bond</th>
              <th>Sell Bond</th>
              <th>Price Diff</th>
              <th>Yield Diff</th>
              <th>Signal</th>
              <th>Confidence</th>
              <th>Matches</th>
            </tr>
          </thead>
          <tbody id="tableBody" role="rowgroup">
            <!-- Data will be inserted here by JavaScript -->
          </tbody>
        </table>
      </div>
      <div id="tableDesc" class="footer">Enhanced Katana design with real-time KatanaSignalEngine data. Click rows for detailed information.</div>
    </section>

    <!-- Chat With The Code - Gradio Interface -->
    <section id="chat" class="blog-post">
      <header class="blog-post-header">
        <h2 class="blog-post-title">Chat With The Code</h2>
        <p class="blog-post-excerpt">Interact with the Katana forensics database through our AI-powered interface. Ask questions about the codebase, architecture, and implementation details.</p>
      </header>
      <div class="blog-post-content">
        <!-- Gradio placeholder -->
        <div id="gradio-container" style="position: relative; width: 100%; min-height: 400px; margin: 2rem 0; background: rgba(255, 255, 255, 0.02); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1); overflow: hidden; display: flex; align-items: center; justify-content: center; flex-direction: column; padding: 3rem;">
          <div style="text-align: center;">
            <h3 style="color: #01a8b5; margin-bottom: 1.5rem; font-size: 1.8rem;">Katana Code Chat Interface</h3>
            <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 2rem; max-width: 600px;">
              Connect to the forensics database and explore the codebase through natural language queries. 
              This interface runs locally on your machine for privacy and performance.
            </p>
            <button class="btn btn--primary btn--large" onclick="loadGradioInterface()" style="margin-bottom: 1rem;">
              Launch Chat Interface
            </button>
            <p style="color: rgba(255, 255, 255, 0.5); font-size: 0.875rem; margin-top: 1rem;">
              Requires local Gradio server on port 7860
            </p>
          </div>
        </div>
        
        <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(1, 168, 181, 0.1); border-left: 3px solid #01a8b5; border-radius: 6px;">
          <p style="margin: 0 0 0.5rem 0; color: rgba(255, 255, 255, 0.87); font-size: 0.95rem;">
            <strong>Setup Instructions:</strong>
          </p>
          <ol style="margin: 0; padding-left: 1.5rem; color: rgba(255, 255, 255, 0.7); font-size: 0.9rem;">
            <li>Navigate to the database directory: <code style="background: rgba(0,0,0,0.3); padding: 0.1rem 0.3rem; border-radius: 3px;">cd database</code></li>
            <li>Run the Gradio app: <code style="background: rgba(0,0,0,0.3); padding: 0.1rem 0.3rem; border-radius: 3px;">python gradio_app.py</code></li>
            <li>Click "Launch Chat Interface" above to connect</li>
          </ol>
        </div>
      </div>
    </section>
    
    <script>
      function loadGradioInterface() {
        const container = document.getElementById('gradio-container');
        container.innerHTML = `
          <div style="position: absolute; width: 100%; padding-bottom: 75%;">
            <iframe 
              id="gradio-chat"
              src="http://localhost:7860" 
              style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 12px;"
              title="Katana Code Chat Interface">
            </iframe>
          </div>
          <div style="position: absolute; top: 1rem; right: 1rem; z-index: 10; display: flex; gap: 0.5rem;">
            <button class="btn btn--secondary" onclick="reloadGradioInterface()" style="padding: 0.5rem 1rem; font-size: 0.875rem;">Refresh</button>
            <button class="btn btn--secondary" onclick="window.open('http://localhost:7860', '_blank')" style="padding: 0.5rem 1rem; font-size: 0.875rem;">Full Screen</button>
          </div>
        `;
        container.style.minHeight = '0';
        container.style.padding = '0';
        container.style.paddingBottom = '75%';
      }
      
      function reloadGradioInterface() {
        const iframe = document.getElementById('gradio-chat');
        if (iframe) {
          iframe.src = iframe.src;
        }
      }
    </script>

    <!-- Contact -->
    <section id="contact" class="blog-post text-center">
      <h2 class="blog-post-title">Let's talk</h2>
      <p class="blog-post-excerpt">Institutional credibility × AI leverage. Fundamentals, not shortcuts.</p>
      <a class="btn btn--primary btn--large" href="https://www.johnshelburne.com" target="_blank" rel="noopener">Contact</a>
    </section>
  </main>

  <!-- Katana Signals JavaScript -->
  <script>
    // Signal data
    const signalsData = [{"priority": 1, "buy_ticker": "ARDAGH", "buy_description": "ARDAGH 5.250% 08/2027 [144A]", "buy_price": 41.57, "buy_ytm": 50.0, "buy_isin": "US03969AAR14", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "CLARIOS", "sell_description": "CLARIOS 8.500% 05/2027 [144A]", "sell_price": 100.17, "sell_ytm": 2.25, "sell_isin": "US69867DAC20", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 58.6, "yield_diff": 47.75, "spread_compression": 4757.9, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 2, "buy_ticker": "ARDAGH", "buy_description": "ARDAGH 5.250% 08/2027 [144A]", "buy_price": 41.9, "buy_ytm": 50.0, "buy_isin": "US03969AAP57", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "CLARIOS", "sell_description": "CLARIOS 8.500% 05/2027 [144A]", "sell_price": 100.17, "sell_ytm": 2.25, "sell_isin": "US69867DAC20", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 58.27, "yield_diff": 47.75, "spread_compression": 4757.9, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 3, "buy_ticker": "ARDAGH", "buy_description": "ARDAGH 5.250% 08/2027 [144A]", "buy_price": 41.57, "buy_ytm": 50.0, "buy_isin": "US03969AAR14", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "AG", "sell_description": "AG 8.630% 09/2027 [144A]", "sell_price": 102.52, "sell_ytm": 3.19, "sell_isin": "US00840KAA79", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 60.95, "yield_diff": 46.81, "spread_compression": 4664.3, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 4, "buy_ticker": "ARDAGH", "buy_description": "ARDAGH 5.250% 08/2027 [144A]", "buy_price": 41.9, "buy_ytm": 50.0, "buy_isin": "US03969AAP57", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "AG", "sell_description": "AG 8.630% 09/2027 [144A]", "sell_price": 102.52, "sell_ytm": 3.19, "sell_isin": "US00840KAA79", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 60.62, "yield_diff": 46.81, "spread_compression": 4664.3, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 5, "buy_ticker": "ARDAGH", "buy_description": "ARDAGH 5.250% 08/2027 [144A]", "buy_price": 41.57, "buy_ytm": 50.0, "buy_isin": "US03969AAR14", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "SIRIUS", "sell_description": "SIRIUS 3.130% 09/2026 [144A]", "sell_price": 99.34, "sell_ytm": 3.81, "sell_isin": "US82967NBL10", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 57.77, "yield_diff": 46.19, "spread_compression": 4610.0, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 6, "buy_ticker": "ARDAGH", "buy_description": "ARDAGH 5.250% 08/2027 [144A]", "buy_price": 41.9, "buy_ytm": 50.0, "buy_isin": "US03969AAP57", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "SIRIUS", "sell_description": "SIRIUS 3.130% 09/2026 [144A]", "sell_price": 99.34, "sell_ytm": 3.81, "sell_isin": "US82967NBL10", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 57.440000000000005, "yield_diff": 46.19, "spread_compression": 4610.0, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 7, "buy_ticker": "UNIFRAX", "buy_description": "UNIFRAX 5.250% 09/2028 [144A]", "buy_price": 32.67, "buy_ytm": 50.0, "buy_isin": "US90473LAA08", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "APTIV", "sell_description": "APTIV 6.880% 12/2054", "sell_price": 101.33, "sell_ytm": 4.28, "sell_isin": "US03837AAD28", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 68.66, "yield_diff": 45.72, "spread_compression": 4560.1, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 8, "buy_ticker": "ALTICE", "buy_description": "ALTICE 6.000% 02/2028 [144A]", "buy_price": 34.87, "buy_ytm": 50.0, "buy_isin": "US02156TAA25", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "APTIV", "sell_description": "APTIV 6.880% 12/2054", "sell_price": 101.33, "sell_ytm": 4.28, "sell_isin": "US03837AAD28", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 66.46000000000001, "yield_diff": 45.72, "spread_compression": 4556.7, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 9, "buy_ticker": "UNIFRAX", "buy_description": "UNIFRAX 5.250% 09/2028 [144A]", "buy_price": 32.67, "buy_ytm": 50.0, "buy_isin": "US90473LAA08", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "DANA", "sell_description": "DANA 4.250% 09/2030", "sell_price": 99.17, "sell_ytm": 4.44, "sell_isin": "US235825AH97", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 66.5, "yield_diff": 45.56, "spread_compression": 4547.5, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 10, "buy_ticker": "ALTICE", "buy_description": "ALTICE 6.000% 02/2028 [144A]", "buy_price": 34.87, "buy_ytm": 50.0, "buy_isin": "US02156TAA25", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "DANA", "sell_description": "DANA 4.250% 09/2030", "sell_price": 99.17, "sell_ytm": 4.44, "sell_isin": "US235825AH97", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 64.30000000000001, "yield_diff": 45.56, "spread_compression": 4544.1, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 11, "buy_ticker": "UNIFRAX", "buy_description": "UNIFRAX 5.250% 09/2028 [144A]", "buy_price": 32.67, "buy_ytm": 50.0, "buy_isin": "US90473LAA08", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "UNITED", "sell_description": "UNITED 3.880% 11/2027", "sell_price": 98.66, "sell_ytm": 4.52, "sell_isin": "US911365BM59", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 65.99, "yield_diff": 45.48, "spread_compression": 4543.8, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 12, "buy_ticker": "ALTICE", "buy_description": "ALTICE 6.000% 02/2028 [144A]", "buy_price": 34.87, "buy_ytm": 50.0, "buy_isin": "US02156TAA25", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "UNITED", "sell_description": "UNITED 3.880% 11/2027", "sell_price": 98.66, "sell_ytm": 4.52, "sell_isin": "US911365BM59", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 63.79, "yield_diff": 45.48, "spread_compression": 4547.2, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 13, "buy_ticker": "ARDAGH", "buy_description": "ARDAGH 5.250% 08/2027 [144A]", "buy_price": 41.57, "buy_ytm": 50.0, "buy_isin": "US03969AAR14", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "CROWN", "sell_description": "CROWN 4.250% 09/2026", "sell_price": 99.7, "sell_ytm": 4.54, "sell_isin": "US22819KAB61", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 58.13, "yield_diff": 45.46, "spread_compression": 4536.4, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 14, "buy_ticker": "ARDAGH", "buy_description": "ARDAGH 5.250% 08/2027 [144A]", "buy_price": 41.9, "buy_ytm": 50.0, "buy_isin": "US03969AAP57", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "CROWN", "sell_description": "CROWN 4.250% 09/2026", "sell_price": 99.7, "sell_ytm": 4.54, "sell_isin": "US22819KAB61", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 57.8, "yield_diff": 45.46, "spread_compression": 4536.4, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 15, "buy_ticker": "UNIFRAX", "buy_description": "UNIFRAX 5.250% 09/2028 [144A]", "buy_price": 32.67, "buy_ytm": 50.0, "buy_isin": "US90473LAA08", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "HOLOGIC", "sell_description": "HOLOGIC 3.250% 02/2029 [144A]", "sell_price": 95.86, "sell_ytm": 4.56, "sell_isin": "US436440AP62", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 63.19, "yield_diff": 45.44, "spread_compression": 4539.6, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 16, "buy_ticker": "ALTICE", "buy_description": "ALTICE 6.000% 02/2028 [144A]", "buy_price": 34.87, "buy_ytm": 50.0, "buy_isin": "US02156TAA25", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "HOLOGIC", "sell_description": "HOLOGIC 3.250% 02/2029 [144A]", "sell_price": 95.86, "sell_ytm": 4.56, "sell_isin": "US436440AP62", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 60.99, "yield_diff": 45.44, "spread_compression": 4536.2, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 17, "buy_ticker": "UNIFRAX", "buy_description": "UNIFRAX 5.250% 09/2028 [144A]", "buy_price": 32.67, "buy_ytm": 50.0, "buy_isin": "US90473LAA08", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "SPIRIT", "sell_description": "SPIRIT 4.600% 06/2028", "sell_price": 100.07, "sell_ytm": 4.57, "sell_isin": "US85205TAK60", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 67.39999999999999, "yield_diff": 45.43, "spread_compression": 4542.8, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 18, "buy_ticker": "ALTICE", "buy_description": "ALTICE 6.000% 02/2028 [144A]", "buy_price": 34.87, "buy_ytm": 50.0, "buy_isin": "US02156TAA25", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "SPIRIT", "sell_description": "SPIRIT 4.600% 06/2028", "sell_price": 100.07, "sell_ytm": 4.57, "sell_isin": "US85205TAK60", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 65.19999999999999, "yield_diff": 45.43, "spread_compression": 4539.8, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 19, "buy_ticker": "UNIFRAX", "buy_description": "UNIFRAX 5.250% 09/2028 [144A]", "buy_price": 32.67, "buy_ytm": 50.0, "buy_isin": "US90473LAA08", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "CALPINE", "sell_description": "CALPINE 3.750% 03/2031 [144A]", "sell_price": 95.55, "sell_ytm": 4.68, "sell_isin": "US131347CR51", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 62.879999999999995, "yield_diff": 45.32, "spread_compression": 4513.8, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}, {"priority": 20, "buy_ticker": "ALTICE", "buy_description": "ALTICE 6.000% 02/2028 [144A]", "buy_price": 34.87, "buy_ytm": 50.0, "buy_isin": "US02156TAA25", "buy_rating": "NR", "buy_sector": "OTHER", "sell_ticker": "CALPINE", "sell_description": "CALPINE 3.750% 03/2031 [144A]", "sell_price": 95.55, "sell_ytm": 4.68, "sell_isin": "US131347CR51", "sell_rating": "NR", "sell_sector": "OTHER", "price_diff": 60.68, "yield_diff": 45.32, "spread_compression": 4510.4, "signal_strength": "STRONG", "confidence": 100.0, "duration_match": true, "sector_match": true}];
    let filteredData = [...signalsData];
    let currentSort = { column: 0, ascending: true };
    
    // Enhanced Katana table rendering
    function renderTable(data) {
      const tbody = document.getElementById('tableBody');
      tbody.innerHTML = '';
      
      // Show first 50 signals (increased from 20)
      const displayData = data.slice(0, 50);
      
      displayData.forEach((signal, index) => {
        const row = document.createElement('tr');
        row.setAttribute('data-priority', signal.priority);
        row.setAttribute('role', 'row');
        row.setAttribute('tabindex', '0');
        row.setAttribute('aria-label', `Signal ${signal.priority}: ${signal.buy_description} vs ${signal.sell_description}`);
        
        // Enhanced row click handling
        row.addEventListener('click', () => handleRowClick(signal));
        row.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            handleRowClick(signal);
          }
        });
        
        // Calculate styling classes
        const priceDiffClass = signal.price_diff >= 0 ? 'positive' : 'negative';
        const yieldDiffClass = signal.yield_diff >= 0 ? 'positive' : 'negative';
        const signalClass = `signal-${signal.signal_strength.toLowerCase()}`;
        const matchIndicator = (signal.duration_match ? '⏱ ' : '') + (signal.sector_match ? '🏢' : '');
        
        row.innerHTML = `
          <td class="priority">${signal.priority}</td>
          <td class="description">
            <div class="bond-title">${signal.buy_description}</div>
            <div class="bond-sub">Price: $${signal.buy_price.toFixed(2)}</div>
          </td>
          <td class="description">
            <div class="bond-title">${signal.sell_description}</div>
            <div class="bond-sub">Price: $${signal.sell_price.toFixed(2)}</div>
          </td>
          <td class="metric ${priceDiffClass}">
            ${Math.abs(signal.price_diff).toFixed(2)}
          </td>
          <td class="metric ${yieldDiffClass}">
            ${Math.abs(signal.yield_diff).toFixed(2)}%
          </td>
          <td class="signal">
            <span class="${signalClass}">
              ${signal.signal_strength}
            </span>
          </td>
          <td class="confidence">
            <div class="confidence-bar" aria-label="Confidence: ${signal.confidence}%">
              <div class="confidence-fill" style="width: ${signal.confidence}%"></div>
            </div>
            <span class="confidence-text">${Math.round(signal.confidence)}%</span>
          </td>
          <td class="match-indicator">${matchIndicator}</td>
        `;
        
        tbody.appendChild(row);
      });
      
      // Add accessibility attributes
      const table = document.getElementById('signalsTable');
      table.setAttribute('role', 'table');
      table.setAttribute('aria-label', 'Katana HYG Trading Signals');
      
      document.getElementById('totalSignals').textContent = data.length;
    }
    
    // Enhanced row click handler with selection
    function handleRowClick(signal) {
      console.log(`Signal ${signal.priority} selected:`, {
        buyBond: signal.buy_description,
        sellBond: signal.sell_description,
        priceDiff: signal.price_diff.toFixed(2),
        confidence: signal.confidence
      });
      
      // Add visual feedback for selection
      const allRows = document.querySelectorAll('tbody tr');
      allRows.forEach(row => row.classList.remove('selected'));
      
      const clickedRow = document.querySelector(`tr[data-priority="${signal.priority}"]`);
      if (clickedRow) {
        clickedRow.classList.add('selected');
      }
    }
    
    // Sorting function
    function sortTable(columnIndex) {
      const columns = ['priority', 'buy_ticker', 'buy_description', 'buy_price', 'buy_ytm',
                     'sell_ticker', 'sell_description', 'sell_price', 'sell_ytm',
                     'price_diff', 'yield_diff', 'signal_strength', 'confidence', 'sector_match'];
      
      const column = columns[columnIndex];
      
      if (currentSort.column === columnIndex) {
        currentSort.ascending = !currentSort.ascending;
      } else {
        currentSort.column = columnIndex;
        currentSort.ascending = true;
      }
      
      filteredData.sort((a, b) => {
        let aVal = a[column];
        let bVal = b[column];
        
        if (typeof aVal === 'string') {
          aVal = aVal.toLowerCase();
          bVal = bVal.toLowerCase();
        }
        
        if (currentSort.ascending) {
          return aVal > bVal ? 1 : -1;
        } else {
          return aVal < bVal ? 1 : -1;
        }
      });
      
      renderTable(filteredData);
    }
    
    // Filter functions
    function applyFilters() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const signalFilter = document.getElementById('signalFilter').value;
      const confidenceFilter = parseFloat(document.getElementById('confidenceFilter').value);
      
      filteredData = signalsData.filter(signal => {
        // Search filter
        if (searchTerm) {
          const searchFields = [
            signal.buy_ticker, signal.buy_description, signal.buy_isin,
            signal.sell_ticker, signal.sell_description, signal.sell_isin
          ].join(' ').toLowerCase();
          
          if (!searchFields.includes(searchTerm)) {
            return false;
          }
        }
        
        // Signal strength filter
        if (signalFilter && signal.signal_strength !== signalFilter) {
          return false;
        }
        
        // Confidence filter
        if (signal.confidence < confidenceFilter) {
          return false;
        }
        
        return true;
      });
      
      renderTable(filteredData);
    }
    
    // Event listeners
    document.getElementById('searchInput').addEventListener('input', applyFilters);
    document.getElementById('signalFilter').addEventListener('change', applyFilters);
    document.getElementById('confidenceFilter').addEventListener('change', applyFilters);
    
    // Initial render
    renderTable(signalsData);
  </script>
</body>
</html>
