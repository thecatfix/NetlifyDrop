<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Katana HYG Signals</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#111827;
      --fg:#ffffff;
      --muted:rgba(255,255,255,0.65);
      --line:rgba(255,255,255,0.1);
      --pos:#a6e3a1;
      --neg:#f38ba8;
      --accent:#00d4e4;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    h1{
      text-align:center;
      margin:1.4rem 0;
      letter-spacing:.02em;
    }
    .table-card{
      max-width:1400px;
      margin:0 auto 2rem auto;
      border:1px solid var(--line);
      border-radius:12px;
      background:var(--card);
      overflow-x:auto;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:.95rem;
      min-width:900px;
    }
    thead th{
      font-weight:700;
      letter-spacing:.08em;
      text-transform:uppercase;
    }
    th, td{
      padding:.9rem .8rem;
      border-bottom:1px solid var(--line);
      text-align:center;
    }
    thead{
      background:rgba(255,255,255,.05);
    }
    thead .group th{
      background:rgba(255,255,255,.06);
      font-size:.85rem;
    }
    .priority{
      font-weight:800;
      font-size:1.1rem;
      white-space:nowrap;
    }
    .bond-cell{
      text-align:left;
      max-width:420px;
    }
    .bond-title{
      font-weight:700;
      font-size:1rem;
    }
    .bond-sub{
      font-size:.82rem;
      color:var(--muted);
      margin-top:.15rem;
    }
    .price{
      font-variant-numeric:tabular-nums;
      white-space:nowrap;
    }
    .metric{
      font-weight:700;
      font-variant-numeric:tabular-nums;
    }
    .metric.positive{ color:var(--pos); }
    .metric.negative{ color:var(--neg); }
    .signal{
      font-weight:800;
      text-transform:uppercase;
      display:inline-block;
      padding:.25rem .6rem;
      border-radius:6px;
    }
    .signal-strong{ background:linear-gradient(90deg,#a6e3a1,#94e2d5); color:#0b1220; }
    .signal-medium{ background:rgba(249,226,175,.2); color:#f9e2af; }
    .signal-weak{ background:rgba(255,255,255,.08); color:var(--muted); }
    .confidence{ white-space:nowrap; }
    .confidence-bar{
      width:120px; height:8px; border-radius:4px;
      background:rgba(255,255,255,.12); overflow:hidden;
      margin:0 auto .25rem auto;
    }
    .confidence-fill{ height:100%; background:var(--accent); }
    .confidence-text{ font-size:.82rem; color:var(--muted); }
    .match-indicator{ font-size:1rem; }
    /* Zebra striping for readability */
    tbody tr:nth-child(even){ background:rgba(255,255,255,0.03); }
  </style>
</head>
<body>
  <h1>Katana HYG Signals</h1>
  <div class="table-card">
    <table id="signalsTable" aria-describedby="Signals for Buy/Sell bond pairs">
      <thead>
        <tr class="group">
          <th rowspan="2">#</th>
          <th colspan="2">Buy Side</th>
          <th colspan="2">Sell Side</th>
          <th rowspan="2">Price Diff</th>
          <th rowspan="2">Signal</th>
          <th rowspan="2">Confidence</th>
          <th rowspan="2">Matches</th>
        </tr>
        <tr>
          <th>Buy Bond</th>
          <th>Price</th>
          <th>Sell Bond</th>
          <th>Price</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <script>
    // Example data (NO rating columns, NO YTM columns)
    const signals = [
      {
        priority: 1,
        buy_description: "ARDAGH 5.250% 08/2027 [144A]",
        buy_price: 41.57,
        sell_description: "CLARIOS 8.500% 05/2027 [144A]",
        sell_price: 100.17,
        price_diff: 58.60,
        signal_strength: "STRONG",
        confidence: 100,
        matchIndicator: "â± ðŸ¢"
      },
      {
        priority: 2,
        buy_description: "ARDAGH 5.250% 08/2027 [144A]",
        buy_price: 41.90,
        sell_description: "CLARIOS 8.500% 05/2027 [144A]",
        sell_price: 100.17,
        price_diff: 58.27,
        signal_strength: "STRONG",
        confidence: 100,
        matchIndicator: "â± ðŸ¢"
      },
      {
        priority: 3,
        buy_description: "ARDAGH 5.250% 08/2027 [144A]",
        buy_price: 41.57,
        sell_description: "AG 8.630% 09/2027 [144A]",
        sell_price: 102.52,
        price_diff: 60.95,
        signal_strength: "STRONG",
        confidence: 100,
        matchIndicator: "â± ðŸ¢"
      }
    ];

    function safeNum(n, d=0){ const x = Number(n); return Number.isFinite(x) ? x : d; }

    function renderTable(rows){
      const tbody = document.getElementById('tableBody');
      tbody.innerHTML = '';
      rows.forEach(signal => {
        const row = document.createElement('tr');
        const priceDiff = safeNum(signal.price_diff);
        row.innerHTML = `
          <td class="priority">${signal.priority ?? ""}</td>

          <!-- Buy Side -->
          <td class="bond-cell">
            <div class="bond-title">${signal.buy_description ?? ""}</div>
          </td>
          <td class="price">$${safeNum(signal.buy_price).toFixed(2)}</td>

          <!-- Sell Side -->
          <td class="bond-cell">
            <div class="bond-title">${signal.sell_description ?? ""}</div>
          </td>
          <td class="price">$${safeNum(signal.sell_price).toFixed(2)}</td>

          <!-- Metrics -->
          <td class="metric ${priceDiff >= 0 ? 'positive' : 'negative'}">
            ${priceDiff.toFixed(2)}
          </td>
          <td class="signal signal-${String(signal.signal_strength || '').toLowerCase()}">
            ${signal.signal_strength ?? ""}
          </td>
          <td class="confidence">
            <div class="confidence-bar" aria-label="Confidence">
              <div class="confidence-fill" style="width: ${safeNum(signal.confidence).toFixed(0)}%"></div>
            </div>
            <span class="confidence-text">${safeNum(signal.confidence).toFixed(0)}%</span>
          </td>
          <td class="match-indicator">${signal.matchIndicator ?? ""}</td>
        `;
        tbody.appendChild(row);
      });
    }

    renderTable(signals);
  </script>
</body>
</html>
